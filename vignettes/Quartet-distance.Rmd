---
title: "Exploring the quartet distance"
author: "Martin R. Smith"
date: "20 November 2017"
output: 
  html_document: 
    keep_md: yes
  pdf_document: default

vignette: >
  %\VignetteIndexEntry{Understanding the quartet distance}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
```{r Load package, include=FALSE}
require('SlowQuartet')
```
# Minimum quartet distance

The quartet distance is necessarily greater than zero when there are more than 
six tips in a tree.

Consider the tree:
```{r Example tree}
tree_a <- ape::read.tree(text="((1, 2), (3, (4, 5)));")
```
```{r Plot trees, echo=FALSE}
plot(tree_a)
```

The only trees with no quartets in common with Tree A are symmetric with
```{r none-in-common}
tree_b <- ape::read.tree(text="((1, 5), (3, (2, 4)));")
```
```{r Plot next tree, echo=FALSE}
plot(tree_b)
```
Now create Tree C by adding a 6th tip as a sister to tip `3` on Tree A.
```{r Add tip 6, echo=FALSE}
plot(ape::read.tree(text="((1, 2), ((3, 6), (4, 5)));"), tip.color=c(1,1,1,2,1,1))
```

There's nowhere to add tip `6` to Tree B without creating a quartet that 
exists in Tree C.


# Quartet distance in a pair of random trees

The quartet distance will average 1/3 for random trees. This is because there are
three quartets involving any set of four tips, each of which is equally likely to 
occur on a truly random tree.

The below code calculates the mean proportion of matching quartets for random 
trees with 4 to 20 tips, and the corresponding standard deviation.

```{r Random trees}
vapply(4:20, function (n_tip) {
 trees <- lapply(1:1000, function (X) ape::rtree(n_tip, tip.label=seq_len(n_tip), br=NULL))
 results <- MatchingQuartets(trees)[1, ] / choose(n_tip, 4)
 c(mean(results[-1]), sd(results[-1]))
}, double(2))

```